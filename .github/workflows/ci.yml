name:  CI

on:
   push:
       branches:  [  main ]
    pull_request:
      branches:  [  main  ]

jobs:
   lint-and-test:
       runs-on:  ubuntu-latest

      steps:
           - name:  Checkout
              uses:  actions/checkout@v4

           - name:  Set  up  Python
             uses:  actions/setup-python@v5
              with:
                 python-version:  "3.11"

          -  name: Install  dependencies
              run:
                 pip  install  ansible ansible-lint  molecule  molecule-plugins[docker]

          -  name: Install  Ansible  collections
              run: ansible-galaxy  collection  install  -r requirements.yml

          -  name:  Run  ansible-lint
             run:  ansible-lint

          -  name:  Run Molecule  tests
              run:  molecule test
